# Валера в пещере - Flask приложение

## Установка

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Запустите приложение:
```bash
python app.py
```

3. Откройте браузер и перейдите по адресу: `http://localhost:5000`

## Структура проекта

- `app.py` - основной файл Flask приложения
- `templates/` - HTML шаблоны
  - `base.html` - базовый шаблон
  - `game.html` - страница игры для класса
  - `rating.html` - страница рейтинга классов
  - `admin/` - панель администратора
    - `classes.html` - управление классами
    - `prizes.html` - управление призами
- `static/` - статические файлы (CSS, JS, изображения)
- `valera.db` - база данных SQLite (создается автоматически)

## Функциональность

### Панель администратора

1. **Управление классами** (`/admin/classes`):
   - Добавление новых классов
   - Редактирование названия и балансов классов
   - Удаление классов

2. **Управление призами** (`/admin/prizes`):
   - Добавление/редактирование/удаление призов для лавки Валеры
   - Добавление/редактирование/удаление призов для лавки учащихся

### Страницы

1. **Рейтинг классов** (`/`) - отображает все классы, отсортированные по общему балансу
2. **Страница игры** (`/class/<id>`) - игровая страница для конкретного класса

## Утилиты

### Добавление задач к боссу из JSON

Скрипт `add_boss_tasks.py` позволяет добавлять задачи к боссу из JSON файла.

**Использование:**
```bash
# По ID босса
python add_boss_tasks.py tasks.json --boss-id 1

# По имени босса
python add_boss_tasks.py tasks.json --boss-name "Имя босса"

# С указанием базового пути для изображений
python add_boss_tasks.py tasks.json --boss-id 1 --image-base-path /path/to/images
```

**Формат JSON файла:**
```json
{
    "tasks": [
        {
            "title": "Название задачи",
            "description": "Описание задачи (опционально)",
            "correct_answer": "Правильный ответ",
            "points": 10,
            "image_path": "path/to/image.png"
        }
    ]
}
```

**Поля задачи:**
- `title` (обязательно) - название задачи
- `correct_answer` (обязательно) - правильный ответ
- `description` (опционально) - описание задачи
- `points` (опционально, по умолчанию 0) - количество очков (урон)
- `image_path` или `image` (опционально) - путь к изображению (относительно JSON файла или абсолютный)

Пример файла: `tasks_example.json`

## API

- `GET /api/class/<id>/balance` - получить баланс класса
- `POST /api/class/<id>/balance` - обновить баланс класса
- `GET /api/classes` - получить список классов
- `POST /api/classes` - создать класс
- `PUT /api/classes/<id>` - обновить класс
- `DELETE /api/classes/<id>` - удалить класс
- `GET /api/prizes` - получить список призов
- `POST /api/prizes` - создать приз
- `PUT /api/prizes/<id>` - обновить приз
- `DELETE /api/prizes/<id>` - удалить приз

